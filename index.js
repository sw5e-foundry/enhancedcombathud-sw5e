/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function r(){return r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},r.apply(this,arguments)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t,n){return a=y()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&h(i,n.prototype),i},a.apply(null,arguments)}function o(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(){l=function(){return e};var e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var a=t&&t.prototype instanceof h?t:h,o=Object.create(a.prototype),s=new E(r||[]);return i(o,"_invoke",{value:x(e,n,s)}),o}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var m={};function h(){}function f(){}function v(){}var y={};c(y,o,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(P([])));b&&b!==n&&r.call(b,o)&&(y=b);var w=v.prototype=h.prototype=Object.create(y);function k(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,n){function a(i,o,s,u){var l=p(e[i],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==t(d)&&r.call(d,"__await")?n.resolve(d.__await).then((function(e){a("next",e,s,u)}),(function(e){a("throw",e,s,u)})):n.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return a("throw",e,s,u)}))}u(l.arg)}var o;i(this,"_invoke",{value:function(e,t){function r(){return new n((function(n,r){a(e,t,n,r)}))}return o=o?o.then(r,r):r()}})}function x(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return{value:void 0,done:!0}}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=S(o,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=p(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function S(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=p(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,m;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function P(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:N}}function N(){return{value:void 0,done:!0}}return f.prototype=v,i(w,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:f,configurable:!0}),f.displayName=c(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},k(A.prototype),c(A.prototype,s,(function(){return this})),e.AsyncIterator=A,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new A(d(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},k(w),c(w,u,"Generator"),c(w,o,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=P,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),m}},e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(void 0,a=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!==t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key),"symbol"===t(a)?a:String(a)),i)}var a}function p(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function f(e){var n=y();return function(){var r,i=g(e);if(n){var a=g(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return function(e,n){if(n&&("object"===t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}(this,r)}}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function b(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){b(a,r,i,o,s,"next",e)}function s(e){b(a,r,i,o,s,"throw",e)}o(void 0)}))}}e.d({},{c:()=>x});var k={};function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x="enhancedcombathud-sw5e";Hooks.on("setup",(function(){!function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=(s=2,function(e){if(Array.isArray(e))return e}(o=n[t])||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(o,s)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}(o,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],a=r[1];game.settings.register(x,i,a)}var o,s}({showWeaponsItems:{name:game.i18n.localize("enhancedcombathud-sw5e.settings.showWeaponsItems.name"),hint:game.i18n.localize("enhancedcombathud-sw5e.settings.showWeaponsItems.hint"),scope:"world",config:!0,type:Boolean,default:!1,onChange:function(e){ui.ARGON.constructor.SW5E.itemTypes.consumable=ui.ARGON.constructor.SW5E.itemTypes.consumable.filter((function(e){return"weapon"!==e})),e&&ui.ARGON.constructor.SW5E.itemTypes.consumable.push("weapon"),ui.ARGON.refresh()}},showClassActions:{name:game.i18n.localize("enhancedcombathud-sw5e.settings.showClassActions.name"),hint:game.i18n.localize("enhancedcombathud-sw5e.settings.showClassActions.hint"),scope:"world",config:!0,type:Boolean,default:!1,onChange:function(e){ui.ARGON.constructor.SW5E.mainBarFeatures=ui.ARGON.constructor.SW5E.mainBarFeatures.filter((function(e){return"class"!==e})),e&&ui.ARGON.constructor.SW5E.mainBarFeatures.push("class"),ui.ARGON.refresh()}},condenseClassActions:{name:game.i18n.localize("enhancedcombathud-sw5e.settings.condenseClassActions.name"),hint:game.i18n.localize("enhancedcombathud-sw5e.settings.condenseClassActions.hint"),scope:"world",config:!0,type:Boolean,default:!0,onChange:function(){return ui.ARGON.refresh()}},switchEquip:{name:game.i18n.localize("enhancedcombathud-sw5e.settings.switchEquip.name"),hint:game.i18n.localize("enhancedcombathud-sw5e.settings.switchEquip.hint"),scope:"world",config:!0,type:Boolean,default:!0,onChange:function(){return ui.ARGON.refresh()}},showSpecialActions:{name:game.i18n.localize("enhancedcombathud-sw5e.settings.showSpecialActions.name"),hint:game.i18n.localize("enhancedcombathud-sw5e.settings.showSpecialActions.hint"),scope:"world",config:!0,type:Boolean,default:!0,onChange:function(){return ui.ARGON.refresh()}},noAA:{name:game.i18n.localize("enhancedcombathud-sw5e.settings.noAA.name"),hint:game.i18n.localize("enhancedcombathud-sw5e.settings.noAA.hint"),scope:"world",config:!0,type:Boolean,default:!1,onChange:function(){return ui.ARGON.refresh()}}}),Hooks.on("argonInit",(function(e){if("sw5e"===game.system.id){!function(){if(k[game.i18n.localize("enhancedcombathud-sw5e.items.dash.name")]={name:game.i18n.localize("enhancedcombathud-sw5e.items.dash.name"),type:"feat",img:"modules/enhancedcombathud/icons/walking-boot.webp",system:{description:{value:game.i18n.localize("enhancedcombathud-sw5e.items.dash.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:null,units:""},target:{value:null,width:null,units:"",type:"self"},range:{value:null,long:null,units:""},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"power"},consumableType:"trinket"},effects:[{_id:"PPMPZY1t3AUB7UGA",changes:[],disabled:!1,duration:{startTime:null,rounds:1},icon:"modules/enhancedcombathud/icons/walking-boot.webp",label:"Dash",transfer:!1,flags:{dae:{stackable:"none",macroRepeat:"none",specialDuration:[],transfer:!1}},tint:""}],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},k[game.i18n.localize("enhancedcombathud-sw5e.items.disengage.name")]={name:game.i18n.localize("enhancedcombathud-sw5e.items.disengage.name"),type:"feat",img:"modules/enhancedcombathud/icons/journey.webp",system:{description:{value:game.i18n.localize("enhancedcombathud-sw5e.items.disengage.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:1,units:"turn"},target:{value:null,width:null,units:"",type:"self"},range:{value:null,long:null,units:""},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"power"}},effects:[{_id:"8FtZnIC1vbyKZ6xF",changes:[],disabled:!1,duration:{startTime:null,turns:1},icon:"modules/enhancedcombathud/icons/journey.webp",label:"Disengage",origin:"Item.wyQkeuZkttllAFB1",transfer:!1,flags:{dae:{stackable:"none",macroRepeat:"none",specialDuration:[],transfer:!1}},tint:""}],sort:0,flags:{core:{sourceId:"Item.wyQkeuZkttllAFB1"},"midi-qol":{onUseMacroName:""}}},k[game.i18n.localize("enhancedcombathud-sw5e.items.dodge.name")]={name:game.i18n.localize("enhancedcombathud-sw5e.items.dodge.name"),type:"feat",img:"modules/enhancedcombathud/icons/armor-upgrade.webp",system:{description:{value:game.i18n.localize("enhancedcombathud-sw5e.items.dodge.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:1,units:"round"},target:{value:null,width:null,units:"",type:"self"},range:{value:null,long:null,units:""},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"power"},consumableType:"trinket"},effects:[{_id:"2xH2YQ6pm430O0Aq",changes:[{key:"flags.sw5e.grants.disadvantage.attack.all",mode:5,value:"1"},{key:"flags.sw5e.advantage.ability.save.dex",mode:5,value:"1"}],disabled:!1,duration:{startTime:null,rounds:1},icon:"modules/enhancedcombathud/icons/armor-upgrade.webp",label:"Dodge",origin:"Item.pakEYcgLYxtKGv7J",transfer:!1,flags:{dae:{stackable:"none",macroRepeat:"none",specialDuration:[],transfer:!1}},tint:""}],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},k[game.i18n.localize("enhancedcombathud-sw5e.items.hide.name")]={name:game.i18n.localize("enhancedcombathud-sw5e.items.hide.name"),type:"feat",img:"modules/enhancedcombathud/icons/cloak-dagger.webp",system:{description:{value:game.i18n.localize("enhancedcombathud-sw5e.items.hide.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:null,units:""},target:{value:null,width:null,units:"",type:"self"},range:{value:null,long:null,units:""},consume:{type:"",target:"",amount:null},recharge:{value:null,charged:!1},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"power"},consumableType:"trinket"},effects:[{_id:"SZkbtgGCICrpH0GJ",changes:[],disabled:!1,duration:{startTime:null,turns:10},icon:"modules/enhancedcombathud/icons/cloak-dagger.webp",label:"Hide",transfer:!1,flags:{dae:{stackable:"none",macroRepeat:"none",specialDuration:[],transfer:!1}},tint:""}],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},k[game.i18n.localize("enhancedcombathud-sw5e.items.grapple.name")]={name:game.i18n.localize("enhancedcombathud-sw5e.items.grapple.name"),type:"feat",img:"modules/enhancedcombathud-sw5e/icons/grab.webp",system:{description:{value:game.i18n.localize("enhancedcombathud-sw5e.items.grapple.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:null,units:""},target:{value:1,width:null,units:"",type:"creature"},range:{value:null,long:null,units:"touch"},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"power"},consumableType:"trinket"},effects:[],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},k[game.i18n.localize("enhancedcombathud-sw5e.items.shove.name")]={name:game.i18n.localize("enhancedcombathud-sw5e.items.shove.name"),type:"feat",img:"modules/enhancedcombathud/icons/shield-bash.webp",system:{description:{value:game.i18n.localize("enhancedcombathud-sw5e.items.shove.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:null,units:""},target:{value:1,width:null,units:"",type:"creature"},range:{value:null,long:null,units:"touch"},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"power"},consumableType:"trinket"},effects:[],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},k[game.i18n.localize("enhancedcombathud-sw5e.items.guard.name")]={name:game.i18n.localize("enhancedcombathud-sw5e.items.guard.name"),type:"feat",img:"modules/enhancedcombathud-sw5e/icons/shield-reflect.webp",system:{description:{value:game.i18n.localize("enhancedcombathud-sw5e.items.guard.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:null,units:""},target:{value:1,width:null,units:"",type:"ally"},range:{value:null,long:null,units:"touch"},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"power"},consumableType:"trinket"},effects:[{_id:"Hl2vvhBqqpvmuont",changes:[{key:"flags.sw5e.grants.disadvantage.attack.all",mode:5,value:"1"}],disabled:!1,duration:{startTime:null,turns:1},icon:"modules/enhancedcombathud/icons/clockwork.webp",label:"Guarded",transfer:!1,flags:{dae:{stackable:"none",macroRepeat:"none",specialDuration:[],transfer:!1}},tint:""}],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},k[game.i18n.localize("enhancedcombathud-sw5e.items.help.name")]={name:game.i18n.localize("enhancedcombathud-sw5e.items.help.name"),type:"feat",img:"modules/enhancedcombathud-sw5e/icons/team-idea.webp",system:{description:{value:game.i18n.localize("enhancedcombathud-sw5e.items.help.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:null,units:""},target:{value:1,width:null,units:"",type:"ally"},range:{value:null,long:null,units:"touch"},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"power"},consumableType:"trinket"},effects:[{_id:"VQnlT5waDLtOPJLF",changes:[{key:"flags.sw5e.situational.advantage.all",mode:5,value:"1"}],disabled:!1,duration:{startTime:null,turns:1},icon:"modules/enhancedcombathud/icons/clockwork.webp",label:"Helped",transfer:!1,flags:{dae:{stackable:"none",macroRepeat:"none",specialDuration:[],transfer:!1}},tint:""}],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},k[game.i18n.localize("enhancedcombathud-sw5e.items.ready.name")]={name:game.i18n.localize("enhancedcombathud-sw5e.items.ready.name"),type:"feat",img:"modules/enhancedcombathud/icons/clockwork.webp",system:{description:{value:game.i18n.localize("enhancedcombathud-sw5e.items.ready.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:null,units:""},target:{value:null,width:null,units:"",type:"self"},range:{value:null,long:null,units:""},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"power"},consumableType:"trinket"},effects:[{_id:"BevDb0J80M9BdoEl",changes:[],disabled:!1,duration:{startTime:null,turns:1},icon:"modules/enhancedcombathud/icons/clockwork.webp",label:"Ready",transfer:!1,flags:{dae:{stackable:"none",macroRepeat:"none",specialDuration:[],transfer:!1}},tint:""}],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},k[game.i18n.localize("enhancedcombathud-sw5e.items.search.name")]={name:game.i18n.localize("enhancedcombathud-sw5e.items.search.name"),type:"feat",img:"modules/enhancedcombathud-sw5e/icons/magnifying-glass.webp",system:{description:{value:game.i18n.localize("enhancedcombathud-sw5e.items.search.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:null,units:""},target:{value:null,width:null,units:"",type:"self"},range:{value:null,long:null,units:""},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"power"},consumableType:"trinket"},effects:[],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},game.settings.get("enhancedcombathud-sw5e","noAA"))for(var e=0,t=Object.keys(k);e<t.length;e++){var n=t[e];delete k[n].effects}}();var t=e.ARGON,s={action:["action"],bonus:["bonus"],reaction:["reaction","reactiondamage","reactionmanual"],free:["special"]},u={power:["power"],maneuver:["maneuver"],feat:["feat"],consumable:["consumable","equipment","loot"]},d=[];game.settings.get(x,"showWeaponsItems")&&u.consumable.push("weapon"),game.settings.get(x,"showClassActions")&&d.push("class"),e.SW5E={actionTypes:s,itemTypes:u,mainBarFeatures:d,ECHItems:k},Hooks.callAll("enhanced-combat-hud.sw5e.initConfig",{actionTypes:s,itemTypes:u,ECHItems:k});var h=function(e){m(i,e);var t,n,r=f(i);function i(){c(this,i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.call.apply(r,[this].concat(t))}return p(i,[{key:"description",get:function(){var e=this.actor,t=e.type,n=e.system,r=this.actor,i="character"===t,a="starship"===t;if("npc"===t){var o,s=game.i18n.localize(null!==(o=CONFIG.SW5E.creatureTypes[r.system.details.type.value])&&void 0!==o?o:r.system.details.type.custom),u=n.details.cr>=1||n.details.cr<=0?n.details.cr:"1/".concat(1/n.details.cr);return"CR ".concat(u," ").concat(s)}if(i){var l=Object.values(r.classes).map((function(e){return e.name})).join(" / ");return"Level ".concat(n.details.level," ").concat(l," (").concat(n.details.species,")")}if(a){var c=Object.values(r.starships).map((function(e){return e.name})).join(" / ");return"Tier ".concat(n.details.tier," ").concat(c)}return""}},{key:"isDead",get:function(){return this.isDying&&"character"!==this.actor.type}},{key:"isDying",get:function(){return this.actor.system.attributes.hp.value<=0}},{key:"successes",get:function(){var e,t;return null!==(e=null===(t=this.actor.system.attributes)||void 0===t||null===(t=t.death)||void 0===t?void 0:t.success)&&void 0!==e?e:0}},{key:"failures",get:function(){var e,t;return null!==(e=null===(t=this.actor.system.attributes)||void 0===t||null===(t=t.death)||void 0===t?void 0:t.failure)&&void 0!==e?e:0}},{key:"configurationTemplate",get:function(){return"modules/enhancedcombathud-sw5e/templates/argon-actor-config.hbs"}},{key:"_onDeathSave",value:(n=w(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.actor.rollDeathSave({});case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getStatBlocks",value:(t=w(l().mark((function e(){var t,n,r,i,a,o,s,u,c,d,p,m,h,f;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="starship"===this.actor.type,n=game.i18n.localize(t?"SW5E.HullPoints":"SW5E.HitPoints").split(" ").map((function(e){return e.charAt(0).toUpperCase()})).join(""),r=game.i18n.localize("SW5E.ArmorClass").split(" ").map((function(e){return e.charAt(0).toUpperCase()})).join(""),!t){e.next=13;break}return u=game.i18n.localize("SW5E.ShieldPoints").split(" ").map((function(e){return e.charAt(0).toUpperCase()})).join(""),c=game.i18n.localize("SW5E.DmgRed").split(" ").map((function(e){return e.charAt(0).toUpperCase()})).join(""),e.abrupt("return",[[{text:"".concat(this.actor.system.attributes.hp.value),color:"rgb(0 255 170)"},{text:"/"},{text:"".concat(this.actor.system.attributes.hp.max),color:"rgb(255 255 255)"},{text:n}],[{text:"".concat(null!==(i=this.actor.system.attributes.hp.temp)&&void 0!==i?i:0),color:"#6698f3"},{text:"/"},{text:"".concat(null!==(a=this.actor.system.attributes.hp.tempmax)&&void 0!==a?a:0),color:"rgb(222 91 255)"},{text:u}],[{text:r},{text:this.actor.system.attributes.ac.value,color:"var(--ech-movement-baseMovement-background)"}],[{text:c},{text:null!==(o=null===(s=this.actor.system.attributes.equip)||void 0===s||null===(s=s.armor)||void 0===s?void 0:s.dr)&&void 0!==o?o:0,color:"var(--ech-movement-baseMovement-background)"}]]);case 13:return m=this.actor.system.attributes.hp.temp?"#6698f3":"rgb(0 255 170)",h=this.actor.system.attributes.hp.tempmax,f=h?h>0?"rgb(222 91 255)":"#ffb000":"rgb(255 255 255)",e.abrupt("return",[[{text:"".concat(this.actor.system.attributes.hp.value+(null!==(d=this.actor.system.attributes.hp.temp)&&void 0!==d?d:0)),color:m},{text:"/"},{text:"".concat(this.actor.system.attributes.hp.max+(null!==(p=this.actor.system.attributes.hp.tempmax)&&void 0!==p?p:0)),color:f},{text:n}],[{text:r},{text:this.actor.system.attributes.ac.value,color:"var(--ech-movement-baseMovement-background)"}]]);case 17:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),i}(t.PORTRAIT.PortraitPanel),y=function(e){m(r,e);var t,n=f(r);function r(e,t,i){var a;return c(this,r),(a=n.call(this,e)).item=t,a.type=i,a}return p(r,[{key:"hasTooltip",get:function(){return!0}},{key:"tooltipOrientation",get:function(){return TooltipManager.TOOLTIP_DIRECTIONS.RIGHT}},{key:"getTooltipData",value:(t=w(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(this.item,this.type);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(t.DRAWER.DrawerButton),b=function(e){m(n,e);var t=f(n);function n(){c(this,n);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return t.call.apply(t,[this].concat(r))}return p(n,[{key:"categories",get:function(){var e=this,t=this.actor.system.abilities,n=this.actor.system.skills,r=this.actor.itemTypes.tool,i=function(e){return e>=0?"+".concat(e):e};return[{gridCols:"5fr 2fr 2fr",captions:[{label:"Abilities",align:"left"},{label:"Check",align:"center"},{label:"Save",align:"center"}],align:["left","center","center"],buttons:Object.keys(t).map((function(n){var r=t[n];return new y([{label:CONFIG.SW5E.abilities[n].label,onClick:function(t){return e.actor.rollAbility(n,{event:t})}},{label:i(r.mod),onClick:function(t){return e.actor.rollAbilityTest(n,{event:t})}},{label:i(r.save),onClick:function(t){return e.actor.rollAbilitySave(n,{event:t})}}],n,"save")}))},{gridCols:"7fr 2fr",captions:[{label:"Skills"},{label:""}],buttons:Object.keys(n).map((function(t){var r=n[t];return new y([{label:F(r.proficient)+CONFIG.SW5E.allSkills[t].label,onClick:function(n){return e.actor.rollSkill(t,{event:n})}},{label:"".concat(i(r.mod),'<span style="margin: 0 1rem; filter: brightness(0.8)">(').concat(r.passive,")</span>"),style:"display: flex; justify-content: flex-end;"}],t,"skill")}))},{gridCols:"7fr 2fr",captions:[{label:"Tools"},{label:""}],buttons:r.map((function(n){return new y([{label:F(n.system.proficient)+n.name,onClick:function(e){return n.rollToolCheck({event:e})}},{label:i(t[n.abilityMod].mod+n.system.proficiencyMultiplier*e.actor.system.attributes.prof)}],n)}))}]}},{key:"title",get:function(){return"".concat(game.i18n.localize("enhancedcombathud-sw5e.hud.saves.name")," / ").concat(game.i18n.localize("enhancedcombathud-sw5e.hud.skills.name")," / ").concat(game.i18n.localize("enhancedcombathud-sw5e.hud.tools.name"))}}]),n}(t.DRAWER.DrawerPanel),A=function(n){m(d,n);var r,i=f(d);function d(){c(this,d);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.call.apply(i,[this].concat(t))}return p(d,[{key:"label",get:function(){return"SW5E.Action"}},{key:"maxActions",get:function(){return this.actor.inCombat?1:null}},{key:"currentActions",get:function(){return this.isActionUsed?0:1}},{key:"_onNewRound",value:function(e){"starship"===this.actor.type&&this.actor.regenRepair(),this.isActionUsed=!1,this.updateActionUse()}},{key:"_getButtons",value:(r=w(l().mark((function n(){var r,i,c,d,p,m,h,f,v,y,g,b,w,A,S,O,T;return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r=[]).push(new N({item:null,isWeaponSet:!0,isPrimary:!0})),"starship"===this.actor.type?(i=this.actor.items.filter((function(e){var t;return u.feat.includes(e.type)&&s.action.includes(null===(t=e.system.activation)||void 0===t?void 0:t.type)})),c=i.filter((function(e){var t;return"starshipAction"===(null===(t=e.system.type)||void 0===t?void 0:t.value)})),d=c.filter((function(e){return"crew"===e.system.type.subtype})),p=c.filter((function(e){return"pilot"===e.system.type.subtype})),m=i.filter((function(e){var t;return"starshipAction"!==(null===(t=e.system.type)||void 0===t?void 0:t.value)||!["crew","pilot"].includes(e.system.type.subtype)})),h=this.actor.items.filter((function(e){var t;return![].concat(o(u.feat),["weapon"]).includes(e.type)&&s.action.includes(null===(t=e.system.activation)||void 0===t?void 0:t.type)&&e.system.equipped})),r.push(new C({type:"crew-action",items:d,color:0})),r.push(new C({type:"pilot-action",items:p,color:0})),r.push(new C({type:"feat",items:m,color:0})),r.push(new C({type:"item",items:h,color:0}))):(f=this.actor.items.filter((function(t){var n,r;return u.power.includes(t.type)&&s.action.includes(null===(n=t.system.activation)||void 0===n?void 0:n.type)&&!e.SW5E.mainBarFeatures.includes(null===(r=t.system.type)||void 0===r?void 0:r.value)})),v=this.actor.items.filter((function(t){var n,r;return u.maneuver.includes(t.type)&&s.action.includes(null===(n=t.system.activation)||void 0===n?void 0:n.type)&&!e.SW5E.mainBarFeatures.includes(null===(r=t.system.type)||void 0===r?void 0:r.value)})),y=this.actor.items.filter((function(t){var n,r;return u.feat.includes(t.type)&&s.action.includes(null===(n=t.system.activation)||void 0===n?void 0:n.type)&&!e.SW5E.mainBarFeatures.includes(null===(r=t.system.type)||void 0===r?void 0:r.value)})),g=this.actor.items.filter((function(t){var n,r;return u.consumable.includes(t.type)&&s.action.includes(null===(n=t.system.activation)||void 0===n?void 0:n.type)&&!e.SW5E.mainBarFeatures.includes(null===(r=t.system.type)||void 0===r?void 0:r.value)})),b=f.length?[new C({type:"power",items:f,color:0})].filter((function(e){return e.hasContents})):[],w=Object.values(k),A=game.settings.get(x,"showSpecialActions"),S=function(e){return new I(w[e])},O=function(e){return a(t.MAIN.BUTTONS.SplitButton,o(e.map(S)))},A&&r.push(O([0,1])),r.push.apply(r,o(b)),A&&r.push(O([2,3])),r.push(new C({type:"maneuver",items:v,color:0})),A&&r.push(O([4,5])),r.push(new C({type:"feat",items:y,color:0})),A&&r.push(O([6,7])),r.push(new C({type:"consumable",items:g,color:0})),A&&r.push(O([8,9]))),T=this.actor.items.filter((function(t){var n,r;return e.SW5E.mainBarFeatures.includes(null===(n=t.system.type)||void 0===n?void 0:n.value)&&s.action.includes(null===(r=t.system.activation)||void 0===r?void 0:r.type)})),r.push.apply(r,o(U(T))),n.abrupt("return",r.filter((function(e){return e.hasContents||null==e.items||e.items.length})));case 6:case"end":return n.stop()}}),n,this)}))),function(){return r.apply(this,arguments)})}]),d}(t.MAIN.ActionPanel),S=function(t){m(a,t);var n,r=f(a);function a(){c(this,a);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.call.apply(r,[this].concat(t))}return p(a,[{key:"label",get:function(){return"SW5E.BonusAction"}},{key:"maxActions",get:function(){return this.actor.inCombat?1:null}},{key:"currentActions",get:function(){return this.isActionUsed?0:1}},{key:"_onNewRound",value:function(e){this.isActionUsed=!1,this.updateActionUse()}},{key:"_getButtons",value:(n=w(l().mark((function t(){var n,r,a,c,d,p=this;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[new N({item:null,isWeaponSet:!0,isPrimary:!1})],r=l().mark((function t(){var r,o,u,d,m;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=i(c[a],2),o=r[0],u=r[1],(d=p.actor.items.filter((function(t){var n,r;return u.includes(t.type)&&s.bonus.includes(null===(n=t.system.activation)||void 0===n?void 0:n.type)&&!e.SW5E.mainBarFeatures.includes(null===(r=t.system.type)||void 0===r?void 0:r.value)}))).length){t.next=4;break}return t.abrupt("return","continue");case 4:(m=new C({type:o,items:d,color:1})).hasContents&&n.push(m);case 6:case"end":return t.stop()}}),t)})),a=0,c=Object.entries(u);case 3:if(!(a<c.length)){t.next=11;break}return t.delegateYield(r(),"t0",5);case 5:if("continue"!==t.t0){t.next=8;break}return t.abrupt("continue",8);case 8:a++,t.next=3;break;case 11:return d=this.actor.items.filter((function(t){var n,r;return e.SW5E.mainBarFeatures.includes(null===(n=t.system.type)||void 0===n?void 0:n.value)&&s.bonus.includes(null===(r=t.system.activation)||void 0===r?void 0:r.type)})),n.push.apply(n,o(U(d))),t.abrupt("return",n);case 14:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]),a}(t.MAIN.ActionPanel),O=function(t){m(a,t);var n,r=f(a);function a(){c(this,a);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.call.apply(r,[this].concat(t))}return p(a,[{key:"label",get:function(){return"SW5E.Reaction"}},{key:"maxActions",get:function(){return this.actor.inCombat?1:null}},{key:"currentActions",get:function(){return this.isActionUsed?0:1}},{key:"_onNewRound",value:function(e){this.isActionUsed=!1,this.updateActionUse()}},{key:"_getButtons",value:(n=w(l().mark((function t(){var n,r,a,c,d,p=this;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[new N({item:null,isWeaponSet:!0,isPrimary:!0})],r=l().mark((function t(){var r,o,u,d,m;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=i(c[a],2),o=r[0],u=r[1],(d=p.actor.items.filter((function(t){var n,r;return u.includes(t.type)&&s.reaction.includes(null===(n=t.system.activation)||void 0===n?void 0:n.type)&&!e.SW5E.mainBarFeatures.includes(null===(r=t.system.type)||void 0===r?void 0:r.value)}))).length){t.next=4;break}return t.abrupt("return","continue");case 4:(m=new C({type:o,items:d,color:3})).hasContents&&n.push(m);case 6:case"end":return t.stop()}}),t)})),a=0,c=Object.entries(u);case 3:if(!(a<c.length)){t.next=11;break}return t.delegateYield(r(),"t0",5);case 5:if("continue"!==t.t0){t.next=8;break}return t.abrupt("continue",8);case 8:a++,t.next=3;break;case 11:return d=this.actor.items.filter((function(t){var n,r;return e.SW5E.mainBarFeatures.includes(null===(n=t.system.type)||void 0===n?void 0:n.value)&&s.reaction.includes(null===(r=t.system.activation)||void 0===r?void 0:r.type)})),n.push.apply(n,o(U(d))),t.abrupt("return",n);case 14:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]),a}(t.MAIN.ActionPanel),T=function(t){m(a,t);var n,r=f(a);function a(){c(this,a);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.call.apply(r,[this].concat(t))}return p(a,[{key:"label",get:function(){return"SW5E.Special"}},{key:"maxActions",get:function(){return this.actor.inCombat?1:null}},{key:"currentActions",get:function(){return this.isActionUsed?0:1}},{key:"_onNewRound",value:function(e){this.isActionUsed=!1,this.updateActionUse()}},{key:"_getButtons",value:(n=w(l().mark((function t(){var n,r,a,c,d,p=this;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=l().mark((function t(){var r,o,u,d,m;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=i(c[a],2),o=r[0],u=r[1],(d=p.actor.items.filter((function(t){var n,r;return u.includes(t.type)&&s.free.includes(null===(n=t.system.activation)||void 0===n?void 0:n.type)&&!e.SW5E.mainBarFeatures.includes(null===(r=t.system.type)||void 0===r?void 0:r.value)}))).length){t.next=4;break}return t.abrupt("return","continue");case 4:(m=new C({type:o,items:d,color:2})).hasContents&&n.push(m);case 6:case"end":return t.stop()}}),t)})),a=0,c=Object.entries(u);case 3:if(!(a<c.length)){t.next=11;break}return t.delegateYield(r(),"t0",5);case 5:if("continue"!==t.t0){t.next=8;break}return t.abrupt("continue",8);case 8:a++,t.next=3;break;case 11:return d=this.actor.items.filter((function(t){var n,r;return e.SW5E.mainBarFeatures.includes(null===(n=t.system.type)||void 0===n?void 0:n.value)&&s.free.includes(null===(r=t.system.activation)||void 0===r?void 0:r.type)})),n.push.apply(n,o(U(d))),t.abrupt("return",n);case 14:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]),a}(t.MAIN.ActionPanel),E=function(e){m(r,e);var t,n=f(r);function r(){c(this,r);for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n.call.apply(n,[this].concat(t))}return p(r,[{key:"label",get:function(){return"SW5E.LegendaryActionLabel"}},{key:"maxActions",get:function(){var e,t;return this.actor.inCombat&&null!==(e=null===(t=this.actor.system.resources)||void 0===t||null===(t=t.legact)||void 0===t?void 0:t.max)&&void 0!==e?e:null}},{key:"currentActions",get:function(){var e,t;return null!==(e=null===(t=this.actor.system.resources)||void 0===t||null===(t=t.legact)||void 0===t?void 0:t.value)&&void 0!==e?e:null}},{key:"_getButtons",value:(t=w(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.actor.items.filter((function(e){var t;return"legendary"===(null===(t=e.system.activation)||void 0===t?void 0:t.type)})).forEach((function(e){t.push(new N({item:e,inActionPanel:!0}))})),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(t.MAIN.ActionPanel),P=function(e){m(r,e);var t,n=f(r);function r(){c(this,r);for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n.call.apply(n,[this].concat(t))}return p(r,[{key:"label",get:function(){return"SW5E.LairActionLabel"}},{key:"maxActions",get:function(){return this.actor.inCombat?1:null}},{key:"currentActions",get:function(){var e,t;return 1*(null!==(e=null===(t=this.actor.system.resources)||void 0===t||null===(t=t.lair)||void 0===t?void 0:t.value)&&void 0!==e?e:0)}},{key:"_getButtons",value:(t=w(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.actor.items.filter((function(e){var t;return"lair"===(null===(t=e.system.activation)||void 0===t?void 0:t.type)})).forEach((function(e){t.push(new N({item:e,inActionPanel:!0}))})),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(t.MAIN.ActionPanel),N=function(e){m(k,e);var t,n,a,o,u,d,h,y,b=f(k);function k(){var e;c(this,k);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=b.call.apply(b,[this].concat(n)),Hooks.on("updateItem",e._onUpdateItem.bind(v(e))),e}return p(k,[{key:"hasTooltip",get:function(){return!0}},{key:"ranges",get:function(){var e,t,n,r,i,a=this.item,o="touch"==a.system.range.units?null===(e=canvas)||void 0===e||null===(e=e.scene)||void 0===e||null===(e=e.grid)||void 0===e?void 0:e.distance:null;return{normal:null!==(t=null===(n=a.system)||void 0===n||null===(n=n.range)||void 0===n?void 0:n.value)&&void 0!==t?t:o,long:null!==(r=null===(i=a.system)||void 0===i||null===(i=i.range)||void 0===i?void 0:i.long)&&void 0!==r?r:null}}},{key:"targets",get:function(){var e,t,n,r=this.item,i=r.system.actionType,a=null===(e=r.system.target)||void 0===e?void 0:e.type;return null!==(t=r.system.target)&&void 0!==t&&t.units||!["creature","ally","enemy"].includes(a)?"mwak"===i||"rwak"===i?1:null:null===(n=r.system.target)||void 0===n?void 0:n.value}},{key:"visible",get:function(){var e;return!this._isWeaponSet||this._isPrimary?r(g(k.prototype),"visible",this):r(g(k.prototype),"visible",this)&&"shield"!==(null===(e=this.item)||void 0===e||null===(e=e.system)||void 0===e||null===(e=e.armor)||void 0===e?void 0:e.type)}},{key:"getTooltipData",value:(y=w(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(this.item);case 2:return(t=e.sent).propertiesLabel="enhancedcombathud-sw5e.tooltip.properties.name",e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"_onTooltipMouseEnter",value:(h=w(l().mark((function e(t){var n,i,a,o,s,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r(g(k.prototype),"_onTooltipMouseEnter",this).call(this,t),s=this.item,console.debug("_onTooltipMouseEnter",null==s||null===(n=s.system)||void 0===n?void 0:n.firingArc,null==s||null===(i=s.system)||void 0===i||null===(i=i.range)||void 0===i?void 0:i.value,null==s?void 0:s.firingArcTemplate),console.debug(this.token.document),null!=s&&null!==(a=s.system)&&void 0!==a&&a.firingArc&&null!==(o=s.system.range)&&void 0!==o&&o.value&&!s.firingArcTemplate)try{s.firingArcTemplate=game.sw5e.canvas.FiringArcTemplate.fromItem(s,{token:this.token.document}),null===(u=s.firingArcTemplate)||void 0===u||u.drawPreview()}catch(e){Hooks.onError("ActorSheet5eStarship._onMouseOverItem",e,{msg:game.i18n.localize("SW5E.PlaceTemplateError"),log:"error",notify:"error"})}case 5:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"_onTooltipMouseLeave",value:(d=w(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(g(k.prototype),"_onTooltipMouseLeave",this).call(this,t),null!=(n=this.item)&&n.firingArcTemplate&&(n.firingArcTemplate._onCancelPlacement(t),n.firingArcTemplate=void 0);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"_onMouseUp",value:(u=w(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(g(k.prototype),"_onMouseUp",this).call(this,t),1===t.button&&this._onMiddleClick(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"_onLeftClick",value:(o=w(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ui.ARGON.interceptNextDialog(t.currentTarget),e.next=3,this.item.use({event:t},{event:t});case 3:e.sent&&(k.consumeActionEconomy(this.item),"maneuver"===this.item.type&&(null===(n=this.parent)||void 0===n||null===(n=n.parent)||void 0===n||n.render()));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"_onMiddleClick",value:(a=w(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.item.reloadWeapon();case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"_onRightClick",value:(n=w(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(n=this.item)||void 0===n||null===(n=n.sheet)||void 0===n||n.render(!0);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"_onUpdateItem",value:function(e){e===this._item&&this.render()}},{key:"render",value:(t=w(l().mark((function e(){var t,n,i,a,o,s=this,u=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=u.length,i=new Array(n),a=0;a<n;a++)i[a]=u[a];return e.next=3,(t=r(g(k.prototype),"render",this)).call.apply(t,[this].concat(i));case 3:this.item&&(o=this.actor.items.filter((function(e){var t;return(null===(t=e.system.consume)||void 0===t?void 0:t.target)===s.item.id})),ui.ARGON.updateItemButtons(o));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"quantity",get:function(){var e,t;if(null===(e=this.item)||void 0===e||!e.system)return null;var n,r,i=null===(t=this.item.system.consume)||void 0===t?void 0:t.type;if(this.item.hasAmmo){var a=this.item.getAmmo;return a.max?Math.floor(a.quantity/a.consumeAmount):null}if("attribute"===i)return Math.floor(getProperty(this.actor.system,this.item.system.consume.target)/this.item.system.consume.amount);if("charges"===i){var o,s,u=this.actor.items.get(this.item.system.consume.target);return u?Math.floor((null!==(o=null===(s=u.system.uses)||void 0===s?void 0:s.value)&&void 0!==o?o:0)/this.item.system.consume.amount):null}return["consumable"].includes(this.item.type)?null!==(n=null===(r=this.item.system.uses)||void 0===r?void 0:r.value)&&void 0!==n?n:this.item.system.quantity:null!==this.item.system.uses.value&&null!==this.item.system.uses.per?this.item.system.uses.value:null}},{key:"quantitySecondary",get:function(){if(this.item.system.hasReload){var e,t=this.item.getAmmo.item;if(t)return null==t||null===(e=t.system)||void 0===e?void 0:e.quantity}return null}}],[{key:"consumeActionEconomy",value:function(e){for(var t,n,r=null===(t=e.system.activation)||void 0===t?void 0:t.type,a=null,o=0,u=Object.entries(s);o<u.length;o++){var l=i(u[o],2),c=l[0];l[1].includes(r)&&(a=c)}a&&((null===(n=game.combat)||void 0===n||null===(n=n.combatant)||void 0===n?void 0:n.actor)!==e.parent&&(a="reaction"),"action"===a?(ui.ARGON.components.main[0].isActionUsed=!0,ui.ARGON.components.main[0].updateActionUse()):"bonus"===a?(ui.ARGON.components.main[1].isActionUsed=!0,ui.ARGON.components.main[1].updateActionUse()):"reaction"===a?(ui.ARGON.components.main[2].isActionUsed=!0,ui.ARGON.components.main[2].updateActionUse()):"free"===a?(ui.ARGON.components.main[3].isActionUsed=!0,ui.ARGON.components.main[3].updateActionUse()):"legendary"===a&&(ui.ARGON.components.main[4].isActionUsed=!0))}}]),k}(t.MAIN.BUTTONS.ItemButton),C=function(e){m(d,e);var a,s,u=f(d);function d(e){var t,n=e.type,r=e.items,i=e.color;return c(this,d),(t=u.call(this)).type=n,t.items=r,t.color=i,t.itemsWithPowers=[],t._powers=t.prePreparePowers(),t}return p(d,[{key:"hasContents",get:function(){return this._powers?!!this._powers.length||!!this.itemsWithPowers.length:!!this.items.length}},{key:"colorScheme",get:function(){return this.color}},{key:"id",get:function(){return"".concat(this.type,"-").concat(this.color)}},{key:"label",get:function(){switch(this.type){case"power":return"enhancedcombathud-sw5e.hud.castpower.name";case"maneuver":return"enhancedcombathud-sw5e.hud.usemaneuver.name";case"feat":return"enhancedcombathud-sw5e.hud.usefeature.name";case"consumable":case"item":return"enhancedcombathud-sw5e.hud.useitem.name";case"crew-action":return"enhancedcombathud-sw5e.hud.crew-action.name";case"pilot-action":return"enhancedcombathud-sw5e.hud.pilot-action.name"}}},{key:"icon",get:function(){switch(this.type){case"power":return"modules/enhancedcombathud/icons/spell-book.webp";case"maneuver":return"modules/enhancedcombathud-sw5e/icons/acrobatic.webp";case"feat":case"crew-action":return"modules/enhancedcombathud/icons/mighty-force.webp";case"pilot-action":return"modules/enhancedcombathud-sw5e/icons/ship-wheel.webp";case"consumable":return"modules/enhancedcombathud/icons/drink-me.webp";case"item":return"modules/enhancedcombathud-sw5e/icons/energise.webp"}}},{key:"showPreparedOnly",get:function(){if("character"!==this.actor.type)return!1;var e=this.actor.getFlag(x,"showPrepared");if("all"===e)return!1;if("preparedOnly"===e)return!0;var t=Object.keys(this.actor.classes);return["cleric","druid","paladin","wizard","artificer","ranger"].some((function(e){return t.includes(e)}))}},{key:"prePreparePowers",value:function(){var e,t=this;if("power"===this.type){var r=CONFIG.SW5E.powerLevels,a=[];if(null!==(e=game.modules.get("items-with-powers-5e"))&&void 0!==e&&e.active){var s,u,l=null===(s=this.items[0].system.activation)||void 0===s?void 0:s.type,c=n(this.actor.items.filter((function(e){var t;return null===(t=e.flags["items-with-powers-5e"])||void 0===t||null===(t=t["item-powers"])||void 0===t?void 0:t.length})));try{var d=function(){var e=u.value,n=e.flags["items-with-powers-5e"]["item-powers"].map((function(e){return t.actor.items.get(e.id)})).filter((function(e){var t;return e&&(null===(t=e.system.activation)||void 0===t?void 0:t.type)===l}));return n.length?(a.push.apply(a,o(n)),1===e.system.attunement?"continue":void t.itemsWithPowers.push({label:e.name,buttons:n.map((function(e){return new N({item:e})})),uses:function(){var t,n;return{max:null===(t=e.system.uses)||void 0===t?void 0:t.max,value:null===(n=e.system.uses)||void 0===n?void 0:n.value}}})):"continue"};for(c.s();!(u=c.n()).done;)d()}catch(e){c.e(e)}finally{c.f()}this.items=this.items.filter((function(e){return!a.includes(e)}))}if(this.showPreparedOnly){var p=["atwill","innate","pact","always"];this.items=this.items.filter((function(e){return!!p.includes(e.system.preparation.mode)||0==e.system.level||e.system.preparation.prepared})),this.items=this.items.filter((function(e){return!a.includes(e)}))}if(this.showPreparedOnly){var m=["atwill","innate","pact","always"];this.items=this.items.filter((function(e){return!!m.includes(e.system.preparation.mode)||0==e.system.level||e.system.preparation.prepared}))}if(this.showPreparedOnly){var h=["atwill","innate","pact","always"];this.items=this.items.filter((function(e){return!!h.includes(e.system.preparation.mode)||0==e.system.level||e.system.preparation.prepared}))}for(var f=[].concat(o(this.itemsWithPowers),[{label:"SW5E.PowerPrepAtWill",buttons:this.items.filter((function(e){return"atwill"===e.system.preparation.mode})).map((function(e){return new N({item:e})}))},{label:"SW5E.PowerPrepInnate",buttons:this.items.filter((function(e){return"innate"===e.system.preparation.mode})).map((function(e){return new N({item:e})}))},{label:Object.values(r)[0],buttons:this.items.filter((function(e){return 0==e.system.level})).map((function(e){return new N({item:e})}))},{label:"SW5E.PactMagic",buttons:this.items.filter((function(e){return"pact"===e.system.preparation.mode})).map((function(e){return new N({item:e})}))}]),v=function(){var e=i(g[y],2),n=e[0],r=e[1],a=t.items.filter((function(e){return e.system.level==n&&("prepared"===e.system.preparation.mode||"always"===e.system.preparation.mode)}));if(!a.length||0==n)return"continue";f.push({label:r,buttons:a.map((function(e){return new N({item:e})}))})},y=0,g=Object.entries(r);y<g.length;y++)v();return f.filter((function(e){return e.buttons.length}))}}},{key:"_getPanel",value:(s=w(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("power"!==this.type){e.next=4;break}return e.abrupt("return",new t.MAIN.BUTTON_PANELS.ACCORDION.AccordionPanel({id:this.id,accordionPanelCategories:this._powers.map((function(e){var t=e.label,n=e.buttons,r=e.uses;return new _({label:t,buttons:n,uses:r})}))}));case 4:return e.abrupt("return",new t.MAIN.BUTTON_PANELS.ButtonPanel({id:this.id,buttons:this.items.map((function(e){return new N({item:e})}))}));case 5:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"_renderInner",value:(a=w(l().mark((function e(){var t,n,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(g(d.prototype),"_renderInner",this).call(this);case 2:t=this.quantity,n=this.quantitySecondary,i=[t,n].reduce((function(e,t,n){return null!==t&&(e+='\n                        <div class="quantity-'.concat(n+1,' multiline">\n                            <div class="border-triangle"></div>\n                            <span>').concat(t,"</span>\n                        </div>")),e}),""),this.element.insertAdjacentHTML("afterbegin",i),null===t&&null===n||(a=(null!=t?t:0)+(null!=n?n:0)===0,this.element.style.filter=a?"grayscale(1)":null);case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"quantity",get:function(){var e;if("maneuver"===this.type)return(null==this||null===(e=this.actor)||void 0===e||null===(e=e.system)||void 0===e||null===(e=e.scale)||void 0===e||null===(e=e.superiority)||void 0===e?void 0:e.dice).value;if("power"===this.type){var t,n=null==this||null===(t=this.actor)||void 0===t||null===(t=t.system)||void 0===t||null===(t=t.attributes)||void 0===t||null===(t=t.force)||void 0===t?void 0:t.points;if(null!=n&&n.max)return"".concat(n.value," FP")}return null}},{key:"quantitySecondary",get:function(){if("power"===this.type){var e,t=null==this||null===(e=this.actor)||void 0===e||null===(e=e.system)||void 0===e||null===(e=e.attributes)||void 0===e||null===(e=e.tech)||void 0===e?void 0:e.points;if(null!=t&&t.max)return"".concat(t.value," TP")}return null}}]),d}(t.MAIN.BUTTONS.ButtonPanelButton),_=function(e){m(n,e);var t=f(n);function n(){return c(this,n),t.apply(this,arguments)}return p(n,[{key:"_setUses",value:function(){var e;return void 0===this.uses.max&&(null===(e=this.buttonContainer.querySelector(".feature-spell-slots"))||void 0===e||e.remove(),this.buttonContainer.style["margin-bottom"]="0px"),r(g(n.prototype),"_setUses",this).call(this)}}]),n}(t.MAIN.BUTTON_PANELS.ACCORDION.AccordionPanelCategory),I=function(e){m(i,e);var t,n,r=f(i);function i(e){var t;c(this,i);var n=(t=r.call(this)).actor.items.getName(e.name);return t.item=null!=n?n:new CONFIG.Item.documentClass(e,{parent:t.actor}),t}return p(i,[{key:"label",get:function(){return this.item.name}},{key:"icon",get:function(){return this.item.img}},{key:"hasTooltip",get:function(){return!0}},{key:"getTooltipData",value:(n=w(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(this.item);case 2:return(t=e.sent).propertiesLabel="enhancedcombathud-sw5e.tooltip.properties.name",e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_onLeftClick",value:(t=w(l().mark((function e(t){var n,r,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(null===(n=game.modules.get("dfreds-convenient-effects"))||void 0===n?void 0:n.active)&&game.dfreds.effectInterface.findEffectByName(this.label),i=!1,!r){e.next=8;break}return i=!0,e.next=6,game.dfreds.effectInterface.toggleEffect(this.label,{overlay:!1,uuids:[this.actor.uuid]});case 6:e.next=11;break;case 8:return e.next=10,this.item.use({event:t},{event:t});case 10:i=e.sent;case 11:i&&N.consumeActionEconomy(this.item);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),i}(t.MAIN.BUTTONS.ActionButton),j=function(e){m(n,e);var t=f(n);function n(){var e,r;c(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(r=t.call.apply(t,[this].concat(a))).getMovementMode=null===(e=game.modules.get("elevation-drag-ruler"))||void 0===e||null===(e=e.api)||void 0===e?void 0:e.getMovementMode,r}return p(n,[{key:"visible",get:function(){var e;return null===(e=game.combat)||void 0===e?void 0:e.started}},{key:"movementMode",get:function(){var e="starship"===this.actor.type;return this.getMovementMode?this.getMovementMode(this.token):e?"space":"walk"}},{key:"movementMax",get:function(){return this.actor.system.attributes.movement[this.movementMode]/canvas.scene.dimensions.distance}}]),n}(t.MovementHud),R=function(e){m(r,e);var t,n=f(r);function r(){c(this,r);for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n.call.apply(n,[this].concat(t))}return p(r,[{key:"visible",get:function(){var e;return!(null!==(e=game.combat)&&void 0!==e&&e.started)}},{key:"_getButtons",value:(t=w(l().mark((function e(){var t,n=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="starship"===this.actor.type,e.abrupt("return",t?[{label:"SW5E.Refitting",onClick:function(e){return n.actor.refittingRepair()},icon:"fas fa-screwdriver-wrench"},{label:"SW5E.Recharge",onClick:function(e){return n.actor.rechargeRepair()},icon:"fas fa-battery-bolt"},{label:"SW5E.Regen",onClick:function(e){return n.actor.regenRepair()},icon:"fas fa-shield-plus"}]:[{label:"SW5E.LongRest",onClick:function(e){return n.actor.longRest()},icon:"fas fa-bed"},{label:"SW5E.ShortRest",onClick:function(e){return n.actor.shortRest()},icon:"fas fa-coffee"}]);case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(t.ButtonHud),W=function(e){m(s,e);var t,n,a,o=f(s);function s(){return c(this,s),o.apply(this,arguments)}return p(s,[{key:"getDefaultSets",value:(a=w(l().mark((function e(){var t,n,i,a,o,u,c,d,p,m,h,f,v,y,b,w,k;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(g(s.prototype),"getDefaultSets",this).call(this);case 2:if(y=e.sent,b=null===(t=this.actor.flags)||void 0===t||null===(t=t.sw5e)||void 0===t?void 0:t.isPolymorphed,"npc"===this.actor.type||b){e.next=6;break}return e.abrupt("return",y);case 6:return w=this.actor.items.filter((function(e){var t;return"weapon"===e.type&&"action"===(null===(t=e.system.activation)||void 0===t?void 0:t.type)})),k=this.actor.items.filter((function(e){var t;return"weapon"===e.type&&"bonus"===(null===(t=e.system.activation)||void 0===t?void 0:t.type)})),e.abrupt("return",{1:{primary:null!==(n=null===(i=w[0])||void 0===i?void 0:i.uuid)&&void 0!==n?n:null,secondary:null!==(a=null===(o=k[0])||void 0===o?void 0:o.uuid)&&void 0!==a?a:null},2:{primary:null!==(u=null===(c=w[1])||void 0===c?void 0:c.uuid)&&void 0!==u?u:null,secondary:null!==(d=null===(p=k[1])||void 0===p?void 0:p.uuid)&&void 0!==d?d:null},3:{primary:null!==(m=null===(h=w[2])||void 0===h?void 0:h.uuid)&&void 0!==m?m:null,secondary:null!==(f=null===(v=k[2])||void 0===v?void 0:v.uuid)&&void 0!==f?f:null}});case 9:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"_getSets",value:(n=w(l().mark((function e(){var t,n,r,a,o,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=this.actor.flags)||void 0===t||null===(t=t.sw5e)||void 0===t?void 0:t.isPolymorphed)){e.next=7;break}return e.next=4,this.getDefaultSets();case 4:e.t0=e.sent,e.next=13;break;case 7:return e.t1=mergeObject,e.next=10,this.getDefaultSets();case 10:e.t2=e.sent,e.t3=deepClone(this.actor.getFlag("enhancedcombathud","weaponSets")||{}),e.t0=(0,e.t1)(e.t2,e.t3);case 13:n=e.t0,r=0,a=Object.entries(n);case 15:if(!(r<a.length)){e.next=36;break}if((o=i(a[r],2))[0],!(s=o[1]).primary){e.next=23;break}return e.next=20,fromUuid(s.primary);case 20:e.t4=e.sent,e.next=24;break;case 23:e.t4=null;case 24:if(s.primary=e.t4,!s.secondary){e.next=31;break}return e.next=28,fromUuid(s.secondary);case 28:e.t5=e.sent,e.next=32;break;case 31:e.t5=null;case 32:s.secondary=e.t5;case 33:r++,e.next=15;break;case 36:return e.abrupt("return",n);case 37:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_onSetChange",value:(t=w(l().mark((function e(t){var n,r,i,a,o,s,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sets,r=t.active,game.settings.get("enhancedcombathud-sw5e","switchEquip")&&"starship"!==this.actor.type){e.next=4;break}return e.abrupt("return");case 4:return i=[],a=n[r],o=Object.values(a).filter((function(e){return e})),s=Object.values(n).filter((function(e){return e!==a})),u=s.flatMap((function(e){return Object.values(e)})).filter((function(e){return e})).filter((function(e){return!o.includes(e)})),o.forEach((function(e){var t;null!==(t=e.system)&&void 0!==t&&t.equipped||i.push({_id:e.id,"system.equipped":!0})})),u.forEach((function(e){var t;null!==(t=e.system)&&void 0!==t&&t.equipped&&i.push({_id:e.id,"system.equipped":!1})})),e.next=13,this.actor.updateEmbeddedDocuments("Item",i);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),s}(t.WeaponSets);e.definePortraitPanel(h),e.defineDrawerPanel(b),e.defineMainPanels([A,S,O,T,E,P,t.PREFAB.PassTurnPanel]),e.defineMovementHud(j),e.defineButtonHud(R),e.defineWeaponSets(W),e.defineSupportedActorTypes(["character","npc","starship"])}function B(e,t){return M.apply(this,arguments)}function M(){return(M=w(l().mark((function e(t,r){var a,o,s,u,c,d,p,m,h,f,v,y,g,b,w,k,A,x,S,O,T,E,P,N,C,_,I,j,R;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y=[],g=[],b="","skill"!=r){e.next=8;break}c=CONFIG.SW5E.allSkills[t].label,d=game.i18n.localize("enhancedcombathud-sw5e.skills.".concat(t,".tooltip")),e.next=45;break;case 8:if("save"!=r){e.next=13;break}c=CONFIG.SW5E.abilities[t].label,d=game.i18n.localize("enhancedcombathud-sw5e.abilities.".concat(t,".tooltip")),e.next=45;break;case 13:if(t&&t.system){e.next=15;break}return e.abrupt("return");case 15:c=t.name,d=t.system.description.value,p=t.type,h=(null===(w=t.labels)||void 0===w?void 0:w.target)||"-",f=(null===(k=t.labels)||void 0===k?void 0:k.range)||"-",g=[],v=null===(A=t.labels)||void 0===A||null===(A=A.damageTypes)||void 0===A?void 0:A.split(", "),y=v&&v.length?v:[],b="",e.t0=p,e.next="weapon"===e.t0?27:"power"===e.t0?31:"consumable"===e.t0?39:"feat"===e.t0?42:45;break;case 27:for(m=CONFIG.SW5E.weaponTypes[t.system.weaponType],g.push(CONFIG.SW5E.itemActionTypes[t.system.actionType]),x=0,S=Object.entries(t.system.properties);x<S.length;x++)O=i(S[x],2),T=O[0],E=O[1],(P=E&&CONFIG.SW5E.weaponProperties[T]?CONFIG.SW5E.weaponProperties[T]:void 0)&&g.push(P.name);return e.abrupt("break",45);case 31:m="".concat(t.labels.level," ").concat(t.labels.school),g.push(CONFIG.SW5E.powerSchools[t.system.school]),g.push(t.labels.duration),g.push(t.labels.save),N=n(t.labels.components.all);try{for(N.s();!(C=N.n()).done;)_=C.value,g.push(_.abbr)}catch(e){N.e(e)}finally{N.f()}return t.labels.materials&&(b=t.labels.materials),e.abrupt("break",45);case 39:return m=CONFIG.SW5E.consumableTypes[t.system.consumableType],g.push(CONFIG.SW5E.itemActionTypes[t.system.actionType]),e.abrupt("break",45);case 42:return m=t.system.requirements,g.push(CONFIG.SW5E.itemActionTypes[t.system.actionType]),e.abrupt("break",45);case 45:if(!d){e.next=49;break}return e.next=48,TextEditor.enrichHTML(d);case 48:d=e.sent;case 49:return I=[],(h||f)&&(I=[{label:"enhancedcombathud-sw5e.tooltip.target.name",value:h},{label:"enhancedcombathud-sw5e.tooltip.range.name",value:f}]),null!=t&&null!==(a=t.labels)&&void 0!==a&&a.toHit&&I.push({label:"enhancedcombathud-sw5e.tooltip.toHit.name",value:t.labels.toHit}),null!=t&&null!==(o=t.labels)&&void 0!==o&&null!==(o=o.derivedDamage)&&void 0!==o&&o.length&&(j="",t.labels.derivedDamage.forEach((function(e){j+=e.formula+" "+q(e.damageType)+" "})),I.push({label:"enhancedcombathud-sw5e.tooltip.damage.name",value:j})),R=[],null!==(s=y)&&void 0!==s&&s.length&&y.forEach((function(e){return R.push({label:e,primary:!0})})),null!==(u=g)&&void 0!==u&&u.length&&g.forEach((function(e){return R.push({label:e,secondary:!0})})),e.abrupt("return",{title:c,description:d,subtitle:m,details:I,properties:R,footerText:b});case 57:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){switch(e.toLowerCase()){case"kinetic":return'<i class="fas fa-sword"></i>';case"acid":return'<i class="fas fa-flask"></i>';case"cold":return'<i class="fas fa-snowflake"></i>';case"energy":return'<i class="fas fa-sword-laser"></i>';case"fire":return'<i class="fas fa-fire"></i>';case"force":return'<i class="fas fa-hand-sparkles"></i>';case"ion":return'<i class="fas fa-user-robot-xmarks"></i>';case"lightning":return'<i class="fas fa-bolt"></i>';case"necrotic":return'<i class="fas fa-skull"></i>';case"poison":return'<i class="fas fa-skull-crossbones"></i>';case"psychic":return'<i class="fas fa-brain"></i>';case"sonic":return'<i class="fas fa-bell"></i>';case"healing":case"temphp":return'<i class="fas fa-heart"></i>';default:return""}}function F(e){return 0==e?'<i style="margin-right: 1ch; pointer-events: none" class="far fa-circle"> </i>':1==e?'<i style="margin-right: 1ch; pointer-events: none" class="fas fa-check"> </i>':2==e?'<i style="margin-right: 1ch; pointer-events: none" class="fas fa-check-double"> </i>':.5==e?'<i style="margin-right: 1ch; pointer-events: none" class="fas fa-adjust"> </i>':'<i style="margin-right: 1ch; pointer-events: none" class="far fa-circle"> </i>'}function U(e){if(!game.settings.get(x,"condenseClassActions"))return e.map((function(e){return new N({item:e,inActionPanel:!0})}));for(var n=[],r=e.length,i=r-r%2,a=null,o=0;o<r;o++){var s=o<i,u=e[o];if(s)if(a){var l=new N({item:u,inActionPanel:!1});n.push(new t.MAIN.BUTTONS.SplitButton(a,l)),a=null}else a=new N({item:u,inActionPanel:!1});else n.push(new N({item:u,inActionPanel:!0}))}return n}}))}))})();
//# sourceMappingURL=index.js.map